var team = [{
        name: "SII",
        color: "#91CCEA",
        font: "#FFF",
        index: 101,
        enabled: true,
        y: 0,
        performance: [{
                name: "最后的钟声响起",
                y: 0,
                new: false
            },
            {
                name: "永恒之光",
                y: 0,
                new: false
            },
            {
                name: "不眠之夜",
                y: 0,
                new: false
            },
            {
                name: "勇气重生",
                y: 0,
                new: false
            },
            {
                name: "让梦想闪耀",
                y: 0,
                new: false
            },
            {
                name: "心的旅程",
                y: 0,
                new: true
            },
            {
                name: "第48区",
                y: 0,
                new: true
            },
            {
                name: "重生计划",
                y: 0,
                new: true
            }
        ]
    },
    {
        name: "NII",
        color: "#AE86BA",
        font: "#FFF",
        index: 102,
        enabled: true,
        y: 0,
        performance: [{
                name: "剧场女神",
                y: 0,
                new: false
            },
            {
                name: "逆流而上",
                y: 0,
                new: false
            },
            {
                name: "前所未有",
                y: 0,
                new: false
            },
            {
                name: "我的太阳",
                y: 0,
                new: false
            },
            {
                name: "专属派对",
                y: 0,
                new: true
            },
            {
                name: "以爱之名",
                y: 0,
                new: true
            },
            {
                name: "时之卷",
                y: 0,
                new: true
            }
        ]
    },
    {
        name: "HII",
        color: "#F49600",
        font: "#FFF",
        index: 103,
        enabled: true,
        y: 0,
        performance: [{
                name: "青春派对",
                y: 0,
                new: false
            },
            {
                name: "手牵手",
                y: 0,
                new: false
            },
            {
                name: "偶像的黎明",
                y: 0,
                new: false
            },
            {
                name: "美丽世界",
                y: 0,
                new: true
            },
            {
                name: "头号新闻",
                y: 0,
                new: true
            }
        ]
    },
    {
        name: "X",
        color: "#94D401",
        font: "#FFF",
        index: 104,
        enabled: true,
        y: 0,
        performance: [{
                name: "梦想的旗帜",
                y: 0,
                new: true
            },
            {
                name: "命运的X号",
                y: 0,
                new: true
            }
        ]
    },
    {
        name: "XII",
        color: "#03C070",
        font: "#FFF",
        index: 105,
        enabled: false,
        y: 0,
        performance: [{
            name: "代号XII",
            y: 0,
            new: true
        }]
    },
    {
        name: "Ft",
        color: "#41b400",
        font: "#E10164",
        index: 106,
        enabled: true,
        y: 0,
        performance: []
    },
    {
        name: "B",
        color: "#EF1B52",
        font: "#FFF",
        index: 201,
        enabled: true,
        y: 0,
        performance: [{
            name: "Be A Fighter",
            y: 0,
            new: true
        }]
    },
    {
        name: "E",
        color: "#00C8C3",
        font: "#FFF",
        index: 202,
        enabled: true,
        y: 0,
        performance: [{
            name: "奇幻加冕礼",
            y: 0,
            new: true
        },{
            name: 'Universe',
            y: 0,
            new: true
        }]
    },
    {
        name: "J",
        color: "#006AB6",
        font: "#FFF",
        index: 203,
        enabled: true,
        y: 0,
        performance: [{ name: "HAKUNA MATATA", y: 0, new: true }]
    },
    {
        name: "BEJ48 预备生",
        "color": "#ff2471",
        "font": "#FFFFFF",
        index: 210,
        enabled: false,
        y: 0,
        performance: []
    },
    {
        name: "G",
        color: "#9FBF40",
        font: "#FFF",
        index: 301,
        enabled: true,
        y: 0,
        performance: [{
            name: "双面偶像",
            y: 0,
            new: true
        }]
    },
    {
        name: "NIII",
        color: "#FFE249",
        font: "#FFF",
        index: 302,
        enabled: true,
        y: 0,
        performance: [{
            name: "第一人称",
            y: 0,
            new: true
        }, {
            name: "Fiona.N",
            y: 0,
            new: true
        }]
    },
    {
        name: "Z",
        color: "#EA617B",
        font: "#FFF",
        index: 303,
        enabled: true,
        y: 0,
        performance: [{
            name: "代号-林和西",
            y: 0,
            new: false
        }, {
            name: "三角函数",
            y: 0,
            new: true
        }]
    },
    {
        name: "GNZ48 预备生",
        color: "#aac913",
        font: "#FFFFFF",
        index: "304",
        enabled: false,
        y: 0,
        performance: []
    },
    {
        name: "SIII",
        color: "#E200CD",
        font: "#FFF",
        index: 401,
        enabled: true,
        y: 0,
        performance: [{
            name: "Idol.S",
            y: 0,
            new: true
        }]
    },
    {
        name: "HIII",
        color: "#8618C2",
        font: "#FFF",
        index: 402,
        enabled: true,
        y: 0,
        performance: []
    }, {
        name: "Y",
        color: "#EA617B",
        font: "#FFFFFF",
        index: 403,
        enabled: false,
        y: 0,
        performance: []
    }, {
        name: "SHY 预备生",
        color: "#EA617B",
        font: "#FFFFFF",
        index: 404,
        enabled: false,
        y: 0,
        performance: []
    },
    {
        name: "C",
        color: "#A46200",
        font: "#FFF",
        index: 501,
        enabled: true,
        y: 0,
        performance: []
    },
    {
        name: "K",
        color: "#FC4F43",
        font: "#FFF",
        index: 502,
        enabled: true,
        y: 0,
        performance: []
    },
    {
        name: "GII",
        color: "transparent",
        font: "transparent",
        index: 503,
        enabled: false,
        y: 0,
        performance: []
    },
    {
        name: "EP",
        color: "#434348",
        font: "#FFF",
        index: 100,
        enabled: false,
        y: 0,
        performance: [{
                index: 0,
                name: "无尽旋转",
                y: 0,
                new: false
            },
            {
                index: 1,
                name: "飞翔入手",
                y: 0,
                new: false
            },
            {
                index: 2,
                name: "爱的幸运曲奇",
                y: 0,
                new: false
            },
            {
                index: 3,
                name: "心电感应",
                y: 0,
                new: false
            },
            {
                index: 4,
                name: "一心向前",
                y: 0,
                new: false
            },
            {
                index: 5,
                name: "UZA",
                y: 0,
                new: false
            },
            {
                index: 6,
                name: "青春的约定",
                y: 0,
                new: false
            },
            {
                index: 7,
                name: "雨季之后",
                y: 0,
                new: false
            },
            {
                index: 8,
                name: "盛夏好声音",
                y: 0,
                new: false
            },
            {
                index: 9,
                name: "万圣节之夜",
                y: 0,
                new: false
            },
            {
                index: 10,
                name: "苦与甜",
                y: 0,
                new: false
            },
            {
                index: 11,
                name: "新年的钟声",
                y: 0,
                new: false
            },
            {
                index: 12,
                name: "源动力",
                y: 0,
                new: true
            },
            {
                index: 13,
                name: "梦想岛",
                y: 0,
                new: true
            },
            {
                index: 14,
                name: "元气觉醒",
                y: 0,
                new: true
            },
            {
                index: 15,
                name: "你所不知道的我",
                y: 0,
                new: true
            },
            {
                index: 16,
                name: "公主披风",
                y: 0,
                new: true
            },
            {
                index: 17,
                name: "浪漫关系",
                y: 0,
                new: true
            },
            {
                index: 18,
                name: "新年这一刻",
                y: 0,
                new: true
            },
            {
                index: 19,
                name: "微笑的向日葵",
                y: 0,
                new: true
            },
            {
                index: 20,
                name: "BOOM!BOOM!BOOM!",
                y: 0,
                new: true
            },
            {
                index: 21,
                name: "彼此的未来",
                y: 0,
                new: true
            },
            {
                index: 22,
                name: "宣言",
                y: 0,
                new: true
            },
            {
                index: 23,
                name: "I.F",
                y: 0,
                new: true
            },
            {
                index: 24,
                name: "夏日柠檬船",
                y: 0,
                new: true
            },
            {
                index: 25,
                name: "SAY NO",
                y: 0,
                new: true
            },
            {
                index: 26,
                name: "百变惊叹号",
                y: 0,
                new: true
            },
            {
                index: 27,
                name: "前行的力量",
                y: 0,
                new: true
            },
            {
                index: 28,
                name: "那不勒斯的黎明",
                y: 0,
                new: true
            },
            {
                index: 29,
                name: "甜蜜盛典",
                y: 0,
                new: true
            },
            {
                index: 30,
                name: "Eyes On Me",
                y: 0,
                new: true
            },
            {
                index: 31,
                name: "Chapter：Blooming 绽放",
                y: 0,
                new: true
            },
            {
                index: 32,
                name: "未来的乐章",
                y: 0,
                new: true
            },
            {
                index: 33,
                name: "森林法则",
                y: 0,
                new: true
            },
            {
                index: 34,
                name: "笔下之城",
                y: 0,
                new: true
            },
            {
                index: 35,
                name: "MAMI",
                y: 0,
                new: true
            },
            {
                index: 36,
                name: "魔女的诗篇",
                y: 0,
                new: true
            },
            {
                index: 37,
                name: "那好吧",
                y: 0,
                new: true
            }
        ]
    },
    {
        name: "组合",
        color: "#DDD",
        font: "#FFF",
        index: 777,
        enabled: false,
        y: 0,
        performance: [{
            name: "7SENSES",
            y: 0,
            new: true
        }, {
            name: "Color Girls",
            y: 0,
            new: true
        }, {
            name: "HO2",
            y: 0,
            new: true
        }, {
            name: "BlueV",
            y: 0,
            new: true
        }]
    },{
        name:'影视',
        color:'#CCC',
        font: "#FFF",
        index: 998,
        enabled: false,
        y: 0,
        performance:[{
            name: "魔天记",
            y: 0,
            new: true
        },{
            name: "贴身校花",
            y: 0,
            new: true
        }]
    }, {
        name: "其它",
        color: "#AAA",
        font: "#FFF",
        index: 999,
        enabled: false,
        y: 0,
        performance: [{
            name: "红白歌战",
            y: 0,
            new: false
        }, {
            name: "1ST B30（131）演唱会",
            y: 0,
            new: false
        }, {
            name: "2ND（725）总选演唱会",
            y: 0,
            new: false
        },{
            name: 'BEJ48成军一周年',
            y:0,
            new: true
        }]
    },
    {
        name: "混合",
        color: "#AAA",
        font: "#FFF",
        index: 1000,
        enabled: false,
        y: 0
    }
];

//每年的小组合情况
var combination = [];

//歌曲组玩法
var songGroup = {
    best: {
        full: 2,
        team: {
            full: 1,
            current: 0
        },
        other: {
            full: 1,
            current: 0
        },
        songs: []
    },
    yy: {
        full: 7,
        team: {
            full: 1,
            current: 0
        },
        solo: {
            full: 1,
            current: 0
        },
        double: {
            full: 2,
            current: 0
        },
        multy: {
            full: 3,
            current: 0
        },
        songs: []
    },
    hy: {
        full: 16,
        team: {
            full: 1,
            current: 0
        },
        solo: {
            full: 2,
            current: 0
        },
        double: {
            full: 6,
            current: 0
        },
        multy: {
            full: 7,
            current: 0
        },
        songs: []
    },
    xc: {
        full: 25,
        team: {
            full: 2,
            current: 0
        },
        other: {
            full: 23,
            current: 0
        },
        songs: []
    }
}

function pushSong(song) {
    switch (song.Type) {
        //队歌
        case 0:
            if (songGroup.best.team.full > songGroup.best.team.current) {
                ++songGroup.best.team.current;
                songGroup.best.songs.push(song);
            } else if (songGroup.yy.team.full > songGroup.yy.team.current) {
                ++songGroup.yy.team.current;
                songGroup.yy.songs.push(song);
            } else if (songGroup.hy.team.full > songGroup.hy.team.current) {
                ++songGroup.hy.team.current;
                songGroup.hy.songs.push(song);
            } else {
                //++songGroup.xc.team.current;
                songGroup.xc.songs.push(song);
            }
            break;
            //Solo
        case 1:
            if (songGroup.best.other.full > songGroup.best.other.current) {
                ++songGroup.best.other.current;
                songGroup.best.songs.push(song);
            } else if (songGroup.yy.solo.full > songGroup.yy.solo.current) {
                ++songGroup.yy.solo.current;
                songGroup.yy.songs.push(song);
            } else if (songGroup.hy.solo.full > songGroup.hy.solo.current) {
                ++songGroup.hy.solo.current;
                songGroup.hy.songs.push(song);
            } else {
                //++songGroup.xc.solo.current;
                songGroup.xc.songs.push(song);
            }
            break;
            //双人
        case 2:
            if (songGroup.best.other.full > songGroup.best.other.current) {
                ++songGroup.best.other.current;
                songGroup.best.songs.push(song);
            } else if (songGroup.yy.double.full > songGroup.yy.double.current) {
                ++songGroup.yy.double.current;
                songGroup.yy.songs.push(song);
            } else if (songGroup.hy.double.full > songGroup.hy.double.current) {
                ++songGroup.hy.double.current;
                songGroup.hy.songs.push(song);
            } else {
                //++songGroup.xc.double.current;
                songGroup.xc.songs.push(song);
            }
            break;
            //多人
        case 3:
        default:
            if (songGroup.best.other.full > songGroup.best.other.current) {
                ++songGroup.best.other.current;
                songGroup.best.songs.push(song);
            } else if (songGroup.yy.multy.full > songGroup.yy.multy.current) {
                ++songGroup.yy.multy.current;
                songGroup.yy.songs.push(song);
            } else if (songGroup.hy.multy.full > songGroup.hy.multy.current) {
                ++songGroup.hy.multy.current;
                songGroup.hy.songs.push(song);
            } else {
                //++songGroup.xc.multy.current;
                songGroup.xc.songs.push(song);
            }
            break;
    }
}

function drawTable() {
    songGroup.best.songs.map(function (s) {
        var member = "";
        $(s.Member).each(function (i, m) {
            if (i == 0) {
                member += '<b style="color:' + getTeamInfo(m.Team).color + '">' + m.Name +
                    '</b>';
            } else {
                member += '<b style="color:' + getTeamInfo(m.Team).color + '">' + m.Name +
                    '</b>';
            }
        });
        $("#table-best").append('<tr><td>' + s.Rank + '</td><td>' + typeTranslate(s.Type) + '</td><td style="color:' + getTeamInfo(s.Member[0].Team).color + '">' + s.Title + '</td><td style="color:' +
            getTeamInfo(s.From[0]).color + '">' + getTeamInfo(s.From[0]).performance[s.From[1]].name + '</td><td>' + calculateNew(s) + '</td><td>' + member + '</td></tr>');
    });

    songGroup.yy.songs.map(function (s) {
        var member = "";
        $(s.Member).each(function (i, m) {
            if (i == 0) {
                member += '<b style="color:' + getTeamInfo(m.Team).color + '">' + m.Name +
                    '</b>';
            } else {
                member += '<b style="color:' + getTeamInfo(m.Team).color + '">' + m.Name +
                    '</b>';
            }
        });
        $("#table-yy").append('<tr><td>' + s.Rank + '</td><td>' + typeTranslate(s.Type) + '</td><td style="color:' + getTeamInfo(s.Member[0].Team).color + '">' + s.Title + '</td><td style="color:' +
            getTeamInfo(s.From[0]).color + '">' + getTeamInfo(s.From[0]).performance[s.From[1]].name + '</td><td>' + calculateNew(s) + '</td><td>' + member + '</td></tr>');
    });

    songGroup.hy.songs.map(function (s) {
        var member = "";
        $(s.Member).each(function (i, m) {
            if (i == 0) {
                member += '<b style="color:' + getTeamInfo(m.Team).color + '">' + m.Name +
                    '</b>';
            } else {
                member += '<b style="color:' + getTeamInfo(m.Team).color + '">' + m.Name +
                    '</b>';
            }
        });
        $("#table-hy").append('<tr><td>' + s.Rank + '</td><td>' + typeTranslate(s.Type) + '</td><td style="color:' + getTeamInfo(s.Member[0].Team).color + '">' + s.Title + '</td><td style="color:' +
            getTeamInfo(s.From[0]).color + '">' + getTeamInfo(s.From[0]).performance[s.From[1]].name + '</td><td>' + calculateNew(s) + '</td><td>' + member + '</td></tr>');
    });

    songGroup.xc.songs.map(function (s) {
        var member = "";
        $(s.Member).each(function (i, m) {
            if (i == 0) {
                member += '<b style="color:' + getTeamInfo(m.Team).color + '">' + m.Name +
                    '</b>';
            } else {
                member += '<b style="color:' + getTeamInfo(m.Team).color + '">' + m.Name +
                    '</b>';
            }
        });
        $("#table-xc").append('<tr><td>' + s.Rank + '</td><td>' + typeTranslate(s.Type) + '</td><td style="color:' + getTeamInfo(s.Member[0].Team).color + '">' + s.Title + '</td><td style="color:' +
            getTeamInfo(s.From[0]).color + '">' + getTeamInfo(s.From[0]).performance[s.From[1]].name + '</td><td>' + calculateNew(s) + '</td><td>' + member + '</td></tr>');
    });
}

function typeTranslate(type) {
    switch (type) {
        case 0:
            return "队歌";
        case 1:
            return "Solo";
        case 2:
            return "双人";
        case 3:
        default:
            return "多人";
    }
}

//计数：原创or复刻
//doNotCalculate=true，不计算
function calculateNew(item, doNotCalculate) {
    if (doNotCalculate) {
        return getTeamInfo(item.From[0]).performance[item.From[1]].new ?
            '<i class="text-success glyphicon glyphicon-ok"></i>' :
            '<i class="text-danger glyphicon glyphicon-remove"></i>';
    } else {
        if (getTeamInfo(item.From[0]).performance[item.From[1]].new) {
            pieNew[0][1] = ++pieNew[0][1];
            //console.log(item.Rank + item.Title + '|' + pieNew[0][1] + '：' + pieNew[1][1]);
            return '<i class="text-success glyphicon glyphicon-ok"></i>';
        } else {
            pieNew[1][1] = ++pieNew[1][1];
            //console.log(item.Rank + item.Title + '|' + pieNew[0][1] + '：' + pieNew[1][1]);
            return '<i class="text-danger glyphicon glyphicon-remove"></i>';
        }
    }
}

function getTeamInfo(index) {
    return team.find(x => x.index == index);
}
